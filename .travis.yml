language: julia

os:
  - linux

julia:
  - 0.6

git:
  depth: 99999999

cache:
  directories:
  - downloads

env:
  global:
  - BINARYBUILDER_DOWNLOADS_CACHE=downloads
  - BINARYBUILDER_AUTOMATIC_APPLE=true

sudo: required

before_script:
  - julia -e 'Pkg.clone("https://github.com/JuliaPackaging/BinaryProvider.jl")'
  - julia -e 'Pkg.clone("https://github.com/JuliaPackaging/BinaryBuilder.jl"); Pkg.build()'

script:
  - julia build_tarballs.jl

deploy:
 provider: releases
 api_key:
   # Note; this api_key is only valid for jgoldfar/BonminCouenneBuilder; you need
   # to make your own: https://docs.travis-ci.com/user/deployment/releases/
   secure: npqkmETRPwCcQKnfPOvIGPwIpwh6ahp8CNVVTocv8t4ep1p6VdRV7R4ox/V2E29i0X3qPf5+Fuze/FC15Qrr8j3QsK3VxCmkrMlR6F0b10iRXXQi7WBFcpEQfvXo21ronZc7a4hZGzf7dS0XJYdGzbyG8BkKrQtR+jyLsSGc/Ks0Chy02GQ3kBafRREb5WXHKRqvNBkz4gbnauuoqq3liAka1ZPtNcQnryIdt/H2j6Ak2Xj/tXX16R/5eqJNMXGYfGMOcteLb9Z2MKX6LAWGYP1UWyWKTNTQ9z8eK713nsQ3GTSjxot54euSfKQWI2gMaJW/Uq7dFxHlolHP3izCp2vrBiiPEI7PvoiXSvjLyyp+yGaR+Cv1pOK8t1IpTeijoLsTLuW/djZK1ZBlmt8q+qMBZ1mjHbAZB3UiVzJUd4tgm4xpXJ8ohYSA2A3HrZIexdyiRwBGFkx3mFqWs+WsMe42RJXYDZvfLOqEJeVfEyik1NufC0s9Hp68ivvj5KWMlIouxC1cSr+6AW8oxs4ynoCiUWzPpDCztXXks0BmYARhv6PC2ehETfBxxCB6/k8FAMXAa07ucbtaeJNCdJK4dmYFSvrYsdK3CB2Eaf8eihbrZ/MnElp64OpMJ8b9E6cg2Vk3CP9C9skIAYwPaXbNjk2ixWvN6UN8zNCrF9vKPQY=
 file_glob: true
 file: products/*
 skip_cleanup: true
 on:
   repo: jgoldfar/BonminCouenneBuilder
   tags: true